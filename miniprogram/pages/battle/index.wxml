<view class="container">
  <!-- é¡¶éƒ¨æ¨ªå¹… -->
  <view class="header-banner">
    <view class="banner-bg-wrapper">
      <image class="banner-bg" src="https://images.unsplash.com/photo-1511196041531-8a8e8e0b5b5e?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxwb2tlciUyMHRhYmxlJTIwY2FyZHMlMjBkYXJrfGVufDF8fHx8MTc2ODgyNzQ4Mnww&ixlib=rb-4.1.0&q=80&w=1080" mode="aspectFill" />
      <view class="banner-overlay"></view>
    </view>
    <view class="banner-content">
      <text class="banner-icon">ğŸ¯</text>
      <text class="banner-title">èµ›äº‹æ¡Œåˆ—è¡¨</text>
    </view>
  </view>

  <!-- åˆ·æ–°æŒ‰é’® -->
  <view class="refresh-header">
    <button class="refresh-btn" bindtap="onRefresh">
      <text>ğŸ”„ åˆ·æ–°</text>
    </button>
  </view>

  <!-- æˆ¿é—´åˆ—è¡¨ -->
  <scroll-view class="rooms-container" scroll-y="true" enable-flex="true">
    <!-- åŠ è½½ä¸­ -->
    <view wx:if="{{loading}}" class="loading-container">
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>

    <!-- æ— æˆ¿é—´æç¤º -->
    <view wx:elif="{{rooms.length === 0}}" class="empty-container">
      <view class="empty-icon">ğŸ´</view>
      <text class="empty-title">å½“å‰æš‚æ— æ­£åœ¨è¿›è¡Œçš„æ¯”èµ›</text>
      <text class="empty-subtitle">è¯·ç¨åå†è¯•</text>
    </view>

    <!-- æˆ¿é—´åˆ—è¡¨ -->
    <view wx:else class="rooms-list">
      <view
        wx:for="{{rooms}}"
        wx:key="id"
        class="room-item"
        bindtap="onJoinRoom"
        data-room-id="{{item.id}}"
        data-room="{{item}}"
      >
        <view class="room-content">
          <!-- æ¡Œå· -->
          <view class="room-header">
            <text class="room-table-number">{{item.tableNumber}}</text>
            <view wx:if="{{item.canJoin}}" class="room-status-badge active">
              <text>å¯åŠ å…¥</text>
            </view>
            <view wx:else class="room-status-badge inactive">
              <text>å·²æ»¡</text>
            </view>
          </view>

          <!-- æ¯”èµ›ä¿¡æ¯ -->
          <view class="room-info">
            <view class="room-info-row">
              <text class="room-info-label">æ¯”èµ›ç±»å‹ï¼š</text>
              <text class="room-info-value">{{item.battleTypeText}}</text>
            </view>
            
            <view wx:if="{{item.name}}" class="room-info-row">
              <text class="room-info-label">èµ›äº‹åç§°ï¼š</text>
              <text class="room-info-value">{{item.name}}</text>
            </view>
            
            <view wx:if="{{item.startTime}}" class="room-info-row">
              <text class="room-info-label">å¼€èµ›æ—¶é—´ï¼š</text>
              <text class="room-info-value">{{item.formattedStartTime}}</text>
            </view>
            
            <view wx:if="{{item.players && item.players.length > 0}}" class="room-info-row">
              <text class="room-info-label">å‚ä¸äººæ•°ï¼š</text>
              <text class="room-info-value">{{item.players.length}}äºº</text>
            </view>
          </view>

          <!-- åŠ å…¥æŒ‰é’® -->
          <view wx:if="{{item.canJoin && isLoggedIn}}" class="room-action">
            <button class="join-btn" catchtap="onJoinRoom" data-room-id="{{item.id}}" data-room="{{item}}">
              <text>åŠ å…¥æ¯”èµ›</text>
            </button>
          </view>
          
          <view wx:elif="{{!isLoggedIn}}" class="room-action">
            <button class="join-btn disabled" disabled>
              <text>è¯·å…ˆç™»å½•</text>
            </button>
          </view>
        </view>
      </view>
    </view>
  </scroll-view>
</view>
